# Restaurant-Discounts

Restaurant-Discounts/
â”œâ”€ apps/
â”‚ â””â”€ web/ # Next.js (App Router) app â€” UI + API routes
â”‚ â”œâ”€ app/ # App Router tree (routes = folders)
â”‚ â”‚ â”œâ”€ layout.tsx # global shell (fonts, <html>, <body>, providers)
â”‚ â”‚ â”œâ”€ page.tsx # "/" â€“ restaurant list (links to details)
â”‚ â”‚ â”œâ”€ admin/ # "/admin" â€“ manual refresh UI (dev only)
â”‚ â”‚ â”‚ â””â”€ page.tsx # date input + POST /api/admin/refresh
â”‚ â”‚ â””â”€ restaurants/
â”‚ â”‚ â””â”€ [id]/ # "/restaurants/:id" â€“ restaurant details
â”‚ â”‚ â”œâ”€ page.tsx # server-render discounts table (+date switcher)
â”‚ â”‚ â”œâ”€ loading.tsx # optional skeleton while route loads
â”‚ â”‚ â””â”€ error.tsx # optional error boundary for this route
â”‚ â”‚
â”‚ â”‚ â””â”€ api/ # Server-only route handlers (Edge/Node)
â”‚ â”‚ â”œâ”€ admin/
â”‚ â”‚ â”‚ â””â”€ refresh/route.ts # POST: bulk refresh via model-server
â”‚ â”‚ â””â”€ restaurants/
â”‚ â”‚ â””â”€ [id]/
â”‚ â”‚ â””â”€ discounts/route.ts # GET: read by date; POST: save accepted rows
â”‚ â”‚
â”‚ â”œâ”€ public/ # Static assets (svgs, icons, etc.)
â”‚ â”‚ â””â”€ favicon.ico
â”‚ â”œâ”€ src/
â”‚ â”‚ â”œâ”€ lib/ # shared logic (isomorphic/server utils)
â”‚ â”‚ â”‚ â”œâ”€ fetchers.ts # server/client fetch helpers (discounts, refresh)
â”‚ â”‚ â”‚ â”œâ”€ modelServer.ts # client to FastAPI /v1/generate
â”‚ â”‚ â”‚ â”œâ”€ restaurants.ts # in-memory catalog + openingHoursToList()
â”‚ â”‚ â”‚ â”œâ”€ store.ts # temp in-mem persistence (to be Prisma)
â”‚ â”‚ â”‚ â””â”€ time.ts # todayYMD(), date helpers
â”‚ â”‚ â””â”€ ui/ # small building blocks (optional)
â”‚ â”‚ â”œâ”€ Button.tsx # basic button
â”‚ â”‚ â”œâ”€ DateInput.tsx # controlled <input type="date" />
â”‚ â”‚ â””â”€ Table.tsx # simple table wrapper
â”‚ â”‚
â”‚ â”œâ”€ .env.local # local vars (CRON_SECRET, MODEL_SERVER_URL, etc.)
â”‚ â”œâ”€ .env.example # documented required/optional keys
â”‚ â”œâ”€ next.config.ts
â”‚ â”œâ”€ tsconfig.json
â”‚ â”œâ”€ postcss.config.mjs
â”‚ â”œâ”€ eslint.config.mjs
â”‚ â””â”€ package.json
â”‚
â”œâ”€ services/
â”‚ â””â”€ model-server/ # Python FastAPI service (ML â€œbrainâ€)
â”‚ â”œâ”€ app.py # /v1/generate: loads model, builds features, predicts
â”‚ â”œâ”€ models/ # model artifacts registry
â”‚ â”‚ â”œâ”€ pasta-place/
â”‚ â”‚ â”‚ â””â”€ 0004_customer_demand_pipeline.pkl
â”‚ â”‚ â”œâ”€ sunset-grill/
â”‚ â”‚ â”‚ â””â”€ 0003_customer_demand_pipeline.pkl
â”‚ â”‚ â””â”€ sushi-house/
â”‚ â”‚ â””â”€ 0005_customer_demand_pipeline.pkl
â”‚ â”œâ”€ pasta_place_2YEAR_data.json # training data (kept here for retraining)
â”‚ â”œâ”€ sunset_grill_2YEAR_data.json
â”‚ â”œâ”€ sushi_house_2YEAR_data.json
â”‚ â”œâ”€ train.ipynb # HGBR pipeline + CV + export .pkl via joblib
â”‚ â”œâ”€ requirements.txt # fastapi, uvicorn, scikit-learn, pandas, numpy, joblibâ€¦
â”‚ â”œâ”€ venv/ # local venv (gitignored)
â”‚ â””â”€ README.md # how to run/train the service
â”‚
â”œâ”€ prisma/ # (planned) DB schema + migrations
â”‚ â”œâ”€ schema.prisma # restaurants, accepted_discounts, reservations, etc.
â”‚ â”œâ”€ migrations/ # generated by `prisma migrate`
â”‚ â””â”€ seed.ts # seed dev data
â”‚
â”œâ”€ scripts/ # helper scripts (optional)
â”‚ â”œâ”€ dev.sh # run Next + model-server together
â”‚ â”œâ”€ refresh.sh # curl POST /api/admin/refresh with date/header
â”‚ â””â”€ train-all.sh # batch training wrapper (notebook or .py)
â”‚
â”œâ”€ .gitignore # node_modules, .next, venv, \*.pkl, .DS_Store, etc.
â””â”€ README.md # top-level overview & getting-started

---

Restaurant-Discounts/
â”œâ”€ apps/
â”‚ â””â”€ web/ # Next.js frontend + API routes (migrated from React)
â”‚ â”œâ”€ app/ # âœ… already exists, core Next.js "App Router"
â”‚ â”‚ â”œâ”€ layout.tsx # âœ… global shell (html/body/providers) â€“ DONE
â”‚ â”‚ â”œâ”€ page.tsx # âœ… "/" restaurant list page â€“ NEEDS styling/data fetch
â”‚ â”‚ â”œâ”€ admin/ # NEW â€“ manual admin UI
â”‚ â”‚ â”‚ â””â”€ page.tsx # ğŸ†• added: form to POST /api/admin/refresh â€“ NEED polish
â”‚ â”‚ â””â”€ restaurants/
â”‚ â”‚ â””â”€ [id]/ # âœ… per-restaurant route
â”‚ â”‚ â”œâ”€ page.tsx # ğŸ†• added: shows discounts table â€“ NEEDS UI work
â”‚ â”‚ â”œâ”€ loading.tsx # ğŸ†• skeleton loader â€“ optional
â”‚ â”‚ â””â”€ error.tsx # ğŸ†• error boundary â€“ optional
â”‚ â”‚
â”‚ â”‚ â””â”€ api/ # âœ… Next.js API handlers (already wired to model-server)
â”‚ â”‚ â”œâ”€ admin/
â”‚ â”‚ â”‚ â””â”€ refresh/route.ts # âœ… bulk refresh â€“ DONE & tested
â”‚ â”‚ â””â”€ restaurants/
â”‚ â”‚ â””â”€ [id]/
â”‚ â”‚ â””â”€ discounts/route.ts # âœ… GET/POST discounts â€“ DONE
â”‚ â”‚
â”‚ â”œâ”€ public/ # âœ… static assets
â”‚ â”‚ â””â”€ favicon.ico
â”‚ â”œâ”€ src/
â”‚ â”‚ â”œâ”€ lib/ # âœ… util layer
â”‚ â”‚ â”‚ â”œâ”€ fetchers.ts # ğŸ†• added: central API fetchers â€“ NEED integration in pages
â”‚ â”‚ â”‚ â”œâ”€ modelServer.ts # âœ… FastAPI client wrapper â€“ DONE
â”‚ â”‚ â”‚ â”œâ”€ restaurants.ts # âœ… restaurant catalog + helpers â€“ DONE
â”‚ â”‚ â”‚ â”œâ”€ store.ts # âœ… in-memory store â€“ TEMP, will swap for Prisma
â”‚ â”‚ â”‚ â””â”€ time.ts # âœ… date helpers â€“ DONE
â”‚ â”‚ â””â”€ ui/ # ğŸ†• new directory for small UI components
â”‚ â”‚ â”œâ”€ Button.tsx # ğŸ†• scaffolded â€“ NEED to flesh out styles
â”‚ â”‚ â”œâ”€ DateInput.tsx # ğŸ†• scaffolded â€“ used by admin form
â”‚ â”‚ â””â”€ Table.tsx # ğŸ†• scaffolded â€“ used by [id]/page.tsx
â”‚ â”‚
â”‚ â”œâ”€ .env.local # âœ… already present â€“ NEEDS MODEL_SERVER_URL
â”‚ â”œâ”€ .env.example # âœ… documented keys
â”‚ â”œâ”€ next.config.ts, tsconfig.json, postcss.config.mjs, eslint.config.mjs
â”‚ â””â”€ package.json # âœ… frontend deps
â”‚
â”œâ”€ services/
â”‚ â””â”€ model-server/ # âœ… FastAPI ML microservice
â”‚ â”œâ”€ app.py # âœ… FastAPI app (with /v1/generate) â€“ WORKING
â”‚ â”œâ”€ models/ # âœ… trained pipelines (joblib .pkl files)
â”‚ â”‚ â”œâ”€ pasta-place/0004_customer_demand_pipeline.pkl
â”‚ â”‚ â”œâ”€ sunset-grill/0003_customer_demand_pipeline.pkl
â”‚ â”‚ â””â”€ sushi-house/0005_customer_demand_pipeline.pkl
â”‚ â”œâ”€ \*\_2YEAR_data.json # âœ… datasets (train/test) â€“ ALREADY LOADED
â”‚ â”œâ”€ train.ipynb # âœ… retraining notebook â€“ NEED hyperparam tuning & cleanup
â”‚ â”œâ”€ requirements.txt # âœ… all Python deps
â”‚ â”œâ”€ venv/ # âœ… local-only, gitignored
â”‚ â””â”€ README.md # ğŸ†• should add training + run docs â€“ NOT WRITTEN
â”‚
â”œâ”€ prisma/ # ğŸš§ not yet wired in
â”‚ â”œâ”€ schema.prisma # ğŸ†• to be written (restaurants, bookings, accepted_discounts)
â”‚ â”œâ”€ migrations/ # empty until first `prisma migrate`
â”‚ â””â”€ seed.ts # ğŸ†• placeholder â€“ will seed restaurant + table data
â”‚
â”œâ”€ scripts/ # ğŸ†• helper scripts (optional but recommended)
â”‚ â”œâ”€ dev.sh # ğŸ†• run Next + model-server together â€“ NOT WRITTEN
â”‚ â”œâ”€ refresh.sh # ğŸ†• curl wrapper for /admin/refresh â€“ NOT WRITTEN
â”‚ â””â”€ train-all.sh # ğŸ†• batch retrain models â€“ NOT WRITTEN
â”‚
â”œâ”€ .gitignore # âœ… ignoring node_modules, .next, venv, .pkl, etc.
â””â”€ README.md # ğŸ†• top-level overview â€“ NOT WRITTEN
